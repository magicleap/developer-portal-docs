---
title: ml_media_drm.h

---

# ml_media_drm.h



## Classes

|                | Name           |
| -------------- | -------------- |
| struct | **[MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md)**  |
| struct | **[MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md)**  |
| struct | **[MLMediaDRMKeyValue](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value.md)**  |
| struct | **[MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md)**  |
| struct | **[MLMediaDRMKeyRequestInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_request_input_param.md)**  |
| struct | **[MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md)** <br></br>Data type that encapsulates either of the following along with an URL:  |
| struct | **[MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md)**  |
| struct | **[MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md)**  |
| struct | **[MLMediaDRMRSAInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_r_s_a_input_param.md)**  |
| struct | **[MLMediaDRMEventInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_info.md)** <br></br>MediaDRM event info associated with a session.  |
| struct | **[MLMediaDRMExpirationUpdateInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_expiration_update_info.md)** <br></br>MediaDRM expiration update info associated with a session.  |
| struct | **[MLMediaDRMKeyStatus](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status.md)** <br></br>MediaDRM key status.  |
| struct | **[MLMediaDRMKeyStatusInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status_info.md)** <br></br>MediaDRM session keys status change info.  |
| struct | **[MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md)** <br></br>Callbacks for notifying client about MLMediaDRM events.  |

## Types

|                | Name           |
| -------------- | -------------- |
| typedef struct [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) | **[MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmbytearray)**  |
| typedef struct [MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md) | **[MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmbytearraylist)**  |
| typedef struct [MLMediaDRMKeyValue](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value.md) | **[MLMediaDRMKeyValue](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmkeyvalue)**  |
| typedef struct [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) | **[MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmkeyvaluearray)**  |
| typedef struct [MLMediaDRMKeyRequestInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_request_input_param.md) | **[MLMediaDRMKeyRequestInputParam](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmkeyrequestinputparam)**  |
| typedef struct [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) | **[MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmrequestmessage)** <br></br>Data type that encapsulates either of the following along with an URL:  |
| typedef struct [MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md) | **[MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmcryptoinputparam)**  |
| typedef struct [MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md) | **[MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmhmacinputparam)**  |
| typedef struct [MLMediaDRMRSAInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_r_s_a_input_param.md) | **[MLMediaDRMRSAInputParam](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmrsainputparam)**  |
| typedef struct [MLMediaDRMEventInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_info.md) | **[MLMediaDRMEventInfo](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmeventinfo)** <br></br>MediaDRM event info associated with a session.  |
| typedef struct [MLMediaDRMExpirationUpdateInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_expiration_update_info.md) | **[MLMediaDRMExpirationUpdateInfo](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmexpirationupdateinfo)** <br></br>MediaDRM expiration update info associated with a session.  |
| typedef struct [MLMediaDRMKeyStatus](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status.md) | **[MLMediaDRMKeyStatus](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmkeystatus)** <br></br>MediaDRM key status.  |
| typedef struct [MLMediaDRMKeyStatusInfo](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status_info.md) | **[MLMediaDRMKeyStatusInfo](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmkeystatusinfo)** <br></br>MediaDRM session keys status change info.  |
| typedef struct [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) | **[MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/group___media_player.md#struct-mlmediadrmeventcallbacks)** <br></br>Callbacks for notifying client about MLMediaDRM events.  |

## Enums

|                | Name           |
| -------------- | -------------- |
| enum | **[MLMediaDRMKeyType](/api-ref/api/Modules/group___media_player/group___media_player.md#enums-mlmediadrmkeytype)** <br></br> { <br></br>[MLMediaDRMKeyType_Streaming](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeytype-streaming) = 1,<br></br> [MLMediaDRMKeyType_Offline](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeytype-offline) = 2,<br></br> [MLMediaDRMKeyType_Release](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeytype-release) = 3,<br></br> [MLMediaDRMKeyType_Ensure32Bits](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeytype-ensure32bits) = 0x7FFFFFFF<br></br>} |
| enum | **[MLMediaDRMEventType](/api-ref/api/Modules/group___media_player/group___media_player.md#enums-mlmediadrmeventtype)** <br></br> { <br></br>[MLMediaDRMEventType_ProvisionRequired](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-provisionrequired) = 1,<br></br> [MLMediaDRMEventType_KeyRequired](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-keyrequired) = 2,<br></br> [MLMediaDRMEventType_KeyExpired](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-keyexpired) = 3,<br></br> [MLMediaDRMEventType_VendorDefined](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-vendordefined) = 4,<br></br> [MLMediaDRMEventType_SessionReclaimed](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-sessionreclaimed) = 5,<br></br> [MLMediaDRMEventType_ExpirationUpdate](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-expirationupdate) = 6,<br></br> [MLMediaDRMEventType_KeysChange](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-keyschange) = 7,<br></br> [MLMediaDRMEventType_Ensure32Bits](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmeventtype-ensure32bits) = 0x7FFFFFFF<br></br>}<br></br>Request event types.  |
| enum | **[MLMediaDRMKeyStatusCode](/api-ref/api/Modules/group___media_player/group___media_player.md#enums-mlmediadrmkeystatuscode)** <br></br> { <br></br>[MLMediaDRMKeyStatusCode_KeyStatusUsable](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-keystatususable) = 0,<br></br> [MLMediaDRMKeyStatusCode_KeyStatusExpired](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-keystatusexpired) = 1,<br></br> [MLMediaDRMKeyStatusCode_KeyStatusOutputNotAllowed](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-keystatusoutputnotallowed) = 2,<br></br> [MLMediaDRMKeyStatusCode_KeyStatusPending](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-keystatuspending) = 3,<br></br> [MLMediaDRMKeyStatusCode_KeyStatusInternalError](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-keystatusinternalerror) = 4,<br></br> [MLMediaDRMKeyStatusCode_Ensure32Bits](/api-ref/api/Files/ml__media__drm_8h.md#enums-mlmediadrmkeystatuscode-ensure32bits) = 0x7FFFFFFF<br></br>}<br></br>Status code associated with a DRM session key.  |

## Functions

|                | Name           |
| -------------- | -------------- |
| void | **[MLMediaDRMEventCallbacksInit](/api-ref/api/Modules/group___media_player/group___media_player.md#void-mlmediadrmeventcallbacksinit)**([MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) * inout_callbacks)<br></br>Initializes [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) with default values.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMByteArrayAllocate](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayallocate)**(size_t size, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_array)<br></br>Allocate byte array buffer.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMByteArrayAllocAndCopy](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayallocandcopy)**(const uint8_t * copy_from, size_t size, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_array)<br></br>Allocate and Copy to byte array buffer.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMKeyValueArrayAllocate](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmkeyvaluearrayallocate)**(size_t size, [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * out_array)<br></br>Allocate array of key/value pairs.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMCreate](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmcreate)**([MLUUID](/api-ref/api/Modules/group___common/struct_m_l_u_u_i_d.md) uuid, [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) * out_handle)<br></br>Create a MLMediaDRM instance from a UUID.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMRelease](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmrelease)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm)<br></br>Release the MLMediaDRM instance.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMByteArrayRelease](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease)**([MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * array)<br></br>Release byte array buffer.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMByteArrayListRelease](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearraylistrelease)**([MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md) * array)<br></br>Release list of byte array buffer.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMKeyValueArrayRelease](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmkeyvaluearrayrelease)**([MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * array)<br></br>Release key/value pair array.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMRequestMessageRelease](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmrequestmessagerelease)**([MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * request)<br></br>Release Request Message.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMKeyValueArrayAdd](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmkeyvaluearrayadd)**(const [MLMediaDRMKeyValue](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value.md) * pair, [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * out_array)<br></br>Add a key/value pair to the array of key/value pairs.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMIsCryptoSchemeSupported](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmiscryptoschemesupported)**([MLUUID](/api-ref/api/Modules/group___common/struct_m_l_u_u_i_d.md) uuid, const char * mime_type, bool * out_supported)<br></br>Query if the given scheme identified by its UUID is supported on this device. And whether the drm plugin is able to handle the media container format.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMSetOnEventListenerEx](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmsetoneventlistenerex)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) * callbacks, void * data)<br></br>Register a callback to be invoked when DRM events or updates or status change occurs.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMOpenSession](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmopensession)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_session_id)<br></br>Opens a new session. A session ID is returned.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMCloseSession](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmclosesession)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id)<br></br>Closes a session on the MLMediaDRM object that was previously opened with openSession().  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetKeyRequest](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetkeyrequest)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMKeyRequestInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_request_input_param.md) * key_request_param, [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * out_key_request)<br></br>A key request/response exchange occurs between the app and a license server to obtain or release keys used to decrypt encrypted content.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMProvideKeyResponse](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * response, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_key_set_id)<br></br>A key response is received from the license server by the app, then it is provided to the DRM engine plugin using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMRestoreKeys](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmrestorekeys)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * key_set_id)<br></br>Restore persisted offline keys into a new session. key_set_id identifies the keys to load, obtained from a prior call to [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMRemoveKeys](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmremovekeys)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * key_set_id)<br></br>Remove the current keys from a session.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMQueryKeyStatus](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmquerykeystatus)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * out_info_map)<br></br>Request an informative description of the key status for the session.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetProvisionRequest](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetprovisionrequest)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const char * cert_type, [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * out_provision_request)<br></br>A provision request/response exchange occurs between the app and a provisioning server to retrieve a device certificate.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMProvideProvisionResponse](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovideprovisionresponse)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * response, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_certificate, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_wrapped_key)<br></br>After a provision response is received by the app, it is provided to the DRM engine plugin using this method.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetSecureStops](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestops)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md) * out_secure_stops)<br></br>Access all secure stops.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetSecureStop](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestop)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * ss_id, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_secure_stop)<br></br>Access secure stop by secure stop ID.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMReleaseSecureStops](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmreleasesecurestops)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * secure_stop)<br></br>Process the SecureStop server response message. After authenticating the message, remove the SecureStops identified in the response. See [MLMediaDRMGetSecureStops()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestops) for details.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMReleaseAllSecureStops](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmreleaseallsecurestops)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm)<br></br>Remove all the SecureStops.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetPropertyString](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetpropertystring)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) property_name, char ** out_property_value)<br></br>Read a DRM engine plugin String property value, given the property name.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMGetPropertyByteArray](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetpropertybytearray)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) property_name, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_property_value)<br></br>Read a DRM engine plugin byte array property value, given the property name.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMSetPropertyString](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmsetpropertystring)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) property_name, const char * property_value)<br></br>Set a DRM engine plugin String property value.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMSetPropertyByteArray](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmsetpropertybytearray)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) property_name, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * property_value)<br></br>Set a DRM engine plugin byte array property value.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMEncrypt](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmencrypt)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md) * crypto_key_param, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * input, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_output)<br></br>Encrypt the data referenced by input using algorithm if specified, and write the encrypted result into output.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMDecrypt](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmdecrypt)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md) * crypto_key_param, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * input, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_output)<br></br>Decrypt the data referenced by input using algorithm if specified, and write the encrypted result into output.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMSign](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmsign)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md) * hmac_key_param, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * message, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_signature)<br></br>Generate a signature using the specified algorithm (if provided) over the message data and store the signature.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMVerify](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmverify)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md) * hmac_key_param, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * message, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * signature, bool * out_match)<br></br>Perform a signature verification using the specified algorithm (if specified) over the message data referenced by the message parameter.  |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) | **[MLMediaDRMSignRSA](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmsignrsa)**([MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) media_drm, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * session_id, const [MLMediaDRMRSAInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_r_s_a_input_param.md) * rsa_key_param, const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * message, [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * out_signature)<br></br>Generate a signature using the specified RSA Key and algorithm.  |

## Attributes

|                | Name           |
| -------------- | -------------- |
| const typedef char * | **[MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty)**  |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) | **[MLMediaDRMProperty_Vendor](/api-ref/api/Modules/group___media_player/group___media_player.md#mlmediadrmproperty-mlmediadrmproperty-vendor)**  |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) | **[MLMediaDRMProperty_Version](/api-ref/api/Modules/group___media_player/group___media_player.md#mlmediadrmproperty-mlmediadrmproperty-version)**  |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) | **[MLMediaDRMProperty_Description](/api-ref/api/Modules/group___media_player/group___media_player.md#mlmediadrmproperty-mlmediadrmproperty-description)**  |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) | **[MLMediaDRMProperty_Algorithms](/api-ref/api/Modules/group___media_player/group___media_player.md#mlmediadrmproperty-mlmediadrmproperty-algorithms)** <br></br>String property name: a comma-separated list of cipher and mac algorithms supported by #CryptoSession. The list may be empty if the DRM engine plugin does not support #CryptoSession operations.  |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) | **[MLMediaDRMProperty_DeviceUniqueID](/api-ref/api/Modules/group___media_player/group___media_player.md#mlmediadrmproperty-mlmediadrmproperty-deviceuniqueid)** <br></br>Byte array property name: the device unique identifier is established during device provisioning and provides a means of uniquely identifying each device.  |

## Enums Documentation

### MLMediaDRMKeyType {#enums-mlmediadrmkeytype}

| Enumerator | Value | Description |
| ---------- | ----- | ----------- |
| MLMediaDRMKeyType_Streaming |  1| This key request type specifies that the keys will be for online use, they will not be saved to the device for subsequent use when the device is not connected to a network. |
| MLMediaDRMKeyType_Offline |  2| This key request type specifies that the keys will be for offline use, they will be saved to the device for use when the device is not connected to a network. |
| MLMediaDRMKeyType_Release |  3| This key request type specifies that previously saved offline keys should be released. |
| MLMediaDRMKeyType_Ensure32Bits |  0x7FFFFFFF| Ensure enum is represented as 32 bits. |




Request types. 





-----------

### MLMediaDRMEventType {#enums-mlmediadrmeventtype}

| Enumerator | Value | Description |
| ---------- | ----- | ----------- |
| MLMediaDRMEventType_ProvisionRequired |  1| This event type indicates that the app needs to request a certificate from the provisioning server. The request message data is obtained using [MLMediaDRMGetProvisionRequest()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetprovisionrequest). |
| MLMediaDRMEventType_KeyRequired |  2| This event type indicates that the app needs to request keys from a license server. The request message data is obtained using [MLMediaDRMGetKeyRequest()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetkeyrequest). |
| MLMediaDRMEventType_KeyExpired |  3| This event type indicates that the licensed usage duration for keys in a session has expired. The keys are no longer valid. |
| MLMediaDRMEventType_VendorDefined |  4| This event may indicate some specific vendor-defined condition, see your DRM provider documentation for details. |
| MLMediaDRMEventType_SessionReclaimed |  5| This event indicates that a session opened by the app has been reclaimed by the resource manager. |
| MLMediaDRMEventType_ExpirationUpdate |  6| This event is issued when a session expiration update occurs, to inform the app about the change in expiration time. If [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) is setup with a valid on_expiration_update callback, then this event is not notified. |
| MLMediaDRMEventType_KeysChange |  7| This event is issued when the keys in a session change status, such as when the license is renewed or expires. If [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) is setup with a valid on_key_status_change callback, then this event is not notified. |
| MLMediaDRMEventType_Ensure32Bits |  0x7FFFFFFF| Ensure enum is represented as 32 bits. |



Request event types. 




**API Level:**
  * 7




-----------

### MLMediaDRMKeyStatusCode {#enums-mlmediadrmkeystatuscode}

| Enumerator | Value | Description |
| ---------- | ----- | ----------- |
| MLMediaDRMKeyStatusCode_KeyStatusUsable |  0| The key is currently usable to decrypt media data. |
| MLMediaDRMKeyStatusCode_KeyStatusExpired |  1| The key is no longer usable to decrypt media data because its expiration time has passed. |
| MLMediaDRMKeyStatusCode_KeyStatusOutputNotAllowed |  2| The key is not currently usable to decrypt media data because its output requirements cannot currently be met. |
| MLMediaDRMKeyStatusCode_KeyStatusPending |  3| The status of the key is not yet known and is being determined. The status will be updated with the actual status when it has been determined. |
| MLMediaDRMKeyStatusCode_KeyStatusInternalError |  4| The key is not currently usable to decrypt media data because of an internal error in processing unrelated to input parameters. This error is not actionable by an app. |
| MLMediaDRMKeyStatusCode_Ensure32Bits |  0x7FFFFFFF| Ensure enum is represented as 32 bits. |



Status code associated with a DRM session key. 




**API Level:**
  * 20




-----------


## Types Documentation

### MLMediaDRMByteArray {#struct-mlmediadrmbytearray}

```cpp
typedef struct MLMediaDRMByteArray MLMediaDRMByteArray;
```


Data type containing byte array buffer and the size. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md)



-----------

### MLMediaDRMByteArrayList {#struct-mlmediadrmbytearraylist}

```cpp
typedef struct MLMediaDRMByteArrayList MLMediaDRMByteArrayList;
```


Data type containing list of byte array buffers and the size. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md)



-----------

### MLMediaDRMKeyValue {#struct-mlmediadrmkeyvalue}

```cpp
typedef struct MLMediaDRMKeyValue MLMediaDRMKeyValue;
```


Data type containing key/value pair. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value.md)



-----------

### MLMediaDRMKeyValueArray {#struct-mlmediadrmkeyvaluearray}

```cpp
typedef struct MLMediaDRMKeyValueArray MLMediaDRMKeyValueArray;
```


Data type containing array of key/value pair. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md)



-----------

### MLMediaDRMKeyRequestInputParam {#struct-mlmediadrmkeyrequestinputparam}

```cpp
typedef struct MLMediaDRMKeyRequestInputParam MLMediaDRMKeyRequestInputParam;
```


Data type that encapsulates Key Request input arguments. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_request_input_param.md)



-----------

### MLMediaDRMRequestMessage {#struct-mlmediadrmrequestmessage}

```cpp
typedef struct MLMediaDRMRequestMessage MLMediaDRMRequestMessage;
```

Data type that encapsulates either of the following along with an URL: 

For Key Request Message: an opaque key request byte array that should be delivered to the license server.

For Provision Request Message: an opaque provision request byte array that should be delivered to the provisioning server. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md)



-----------

### MLMediaDRMCryptoInputParam {#struct-mlmediadrmcryptoinputparam}

```cpp
typedef struct MLMediaDRMCryptoInputParam MLMediaDRMCryptoInputParam;
```


Data type that encapsulates algorithm, key_set_id and IV for Encryption/Decryption. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md)



-----------

### MLMediaDRMHMACInputParam {#struct-mlmediadrmhmacinputparam}

```cpp
typedef struct MLMediaDRMHMACInputParam MLMediaDRMHMACInputParam;
```


Data type that encapsulates algorithm, key_set_id for HMAC based Sign/Verify. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md)



-----------

### MLMediaDRMRSAInputParam {#struct-mlmediadrmrsainputparam}

```cpp
typedef struct MLMediaDRMRSAInputParam MLMediaDRMRSAInputParam;
```


Data type that encapsulates algorithm, wrapped_key for RSA operation. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_r_s_a_input_param.md)



-----------

### MLMediaDRMEventInfo {#struct-mlmediadrmeventinfo}

```cpp
typedef struct MLMediaDRMEventInfo MLMediaDRMEventInfo;
```

MediaDRM event info associated with a session. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_info.md)


**API Level:**
  * 20




-----------

### MLMediaDRMExpirationUpdateInfo {#struct-mlmediadrmexpirationupdateinfo}

```cpp
typedef struct MLMediaDRMExpirationUpdateInfo MLMediaDRMExpirationUpdateInfo;
```

MediaDRM expiration update info associated with a session. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_expiration_update_info.md)


**API Level:**
  * 20




-----------

### MLMediaDRMKeyStatus {#struct-mlmediadrmkeystatus}

```cpp
typedef struct MLMediaDRMKeyStatus MLMediaDRMKeyStatus;
```

MediaDRM key status. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status.md)


**API Level:**
  * 20




-----------

### MLMediaDRMKeyStatusInfo {#struct-mlmediadrmkeystatusinfo}

```cpp
typedef struct MLMediaDRMKeyStatusInfo MLMediaDRMKeyStatusInfo;
```

MediaDRM session keys status change info. 



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_status_info.md)


**API Level:**
  * 20




-----------

### MLMediaDRMEventCallbacks {#struct-mlmediadrmeventcallbacks}

```cpp
typedef struct MLMediaDRMEventCallbacks MLMediaDRMEventCallbacks;
```

Callbacks for notifying client about MLMediaDRM events. 

User of MLMediaDRM should implement this.



[More Info](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md)


**API Level:**
  * 20




-----------


## Functions Documentation

### MLMediaDRMEventCallbacksInit {#void-mlmediadrmeventcallbacksinit}

```cpp
static inline void MLMediaDRMEventCallbacksInit(
    MLMediaDRMEventCallbacks * inout_callbacks
)
```

Initializes [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) with default values. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) * |inout_callbacks|MediaDRM Callback structure defined by [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) that needs to be initialized. |




-----------

### MLMediaDRMByteArrayAllocate {#mlresult-mlmediadrmbytearrayallocate}

```cpp
MLResult MLMediaDRMByteArrayAllocate(
    size_t size,
    MLMediaDRMByteArray * out_array
)
```

Allocate byte array buffer. 

**Parameters**

|  |   |   |
|--|--|--|
| size_t |size|Maximum size of the desirable byte array to be allocated. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_array|Pointer to byte array buffer that needs to be allocated. To free/release, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_AllocFailed|Failed because of allocation failure. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Byte Array is allocated successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMByteArrayAllocAndCopy {#mlresult-mlmediadrmbytearrayallocandcopy}

```cpp
MLResult MLMediaDRMByteArrayAllocAndCopy(
    const uint8_t * copy_from,
    size_t size,
    MLMediaDRMByteArray * out_array
)
```

Allocate and Copy to byte array buffer. 

**Parameters**

|  |   |   |
|--|--|--|
| const uint8_t * |copy_from|Buffer from which copy into byte array. |
| size_t |size|Number of bytes to be copied. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_array|Pointer to byte array buffer that needs to be allocated and copied to. To free/release, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_AllocFailed|Failed because of allocation failure. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Byte Array is allocated and copied successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMKeyValueArrayAllocate {#mlresult-mlmediadrmkeyvaluearrayallocate}

```cpp
MLResult MLMediaDRMKeyValueArrayAllocate(
    size_t size,
    MLMediaDRMKeyValueArray * out_array
)
```

Allocate array of key/value pairs. 

**Parameters**

|  |   |   |
|--|--|--|
| size_t |size|Maximum size of the desirable array of key/value pair to be allocated. |
| [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * |out_array|Pointer to array of key/value pair that needs to be allocated. To free/release, call [MLMediaDRMKeyValueArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmkeyvaluearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_AllocFailed|Failed because of allocation failure. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Key/value pair array is allocated successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMCreate {#mlresult-mlmediadrmcreate}

```cpp
MLResult MLMediaDRMCreate(
    MLUUID uuid,
    MLHandle * out_handle
)
```

Create a MLMediaDRM instance from a UUID. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLUUID](/api-ref/api/Modules/group___common/struct_m_l_u_u_i_d.md) |uuid|The universal unique ID of the crypto scheme. uuid must be 16 bytes. |
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) * |out_handle|Upon successful return will point to handle to the created MLMediaDRM. Or else, it will point to [ML_INVALID_HANDLE](/api-ref/api/Modules/group___platform/group___platform.md#enums-ml-invalid-handle).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_AllocFailed|MLMediaDRM object creation failed with resource allocation failure. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM object was created successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMRelease {#mlresult-mlmediadrmrelease}

```cpp
MLResult MLMediaDRMRelease(
    MLHandle media_drm
)
```

Release the MLMediaDRM instance. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM object was released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMByteArrayRelease {#mlresult-mlmediadrmbytearrayrelease}

```cpp
MLResult MLMediaDRMByteArrayRelease(
    MLMediaDRMByteArray * array
)
```

Release byte array buffer. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |array|Byte array buffer that needs to be released.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Byte Array was released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMByteArrayListRelease {#mlresult-mlmediadrmbytearraylistrelease}

```cpp
MLResult MLMediaDRMByteArrayListRelease(
    MLMediaDRMByteArrayList * array
)
```

Release list of byte array buffer. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md) * |array|List of byte array buffer that needs to be released.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Byte Array List was released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMKeyValueArrayRelease {#mlresult-mlmediadrmkeyvaluearrayrelease}

```cpp
MLResult MLMediaDRMKeyValueArrayRelease(
    MLMediaDRMKeyValueArray * array
)
```

Release key/value pair array. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * |array|Key/value pair array that needs to be released.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Key/value pair array was released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMRequestMessageRelease {#mlresult-mlmediadrmrequestmessagerelease}

```cpp
MLResult MLMediaDRMRequestMessageRelease(
    MLMediaDRMRequestMessage * request
)
```

Release Request Message. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * |request|Pointer to Request Message that needs to be released.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|DRM Request Message was released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMKeyValueArrayAdd {#mlresult-mlmediadrmkeyvaluearrayadd}

```cpp
MLResult MLMediaDRMKeyValueArrayAdd(
    const MLMediaDRMKeyValue * pair,
    MLMediaDRMKeyValueArray * out_array
)
```

Add a key/value pair to the array of key/value pairs. 

**Parameters**

|  |   |   |
|--|--|--|
| const [MLMediaDRMKeyValue](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value.md) * |pair|The source key/value pair that needs to be added. |
| [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * |out_array|Pointer to array of key/value pair to which the pair needs to be added to.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|One of the parameters is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|key/value pair is added successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMIsCryptoSchemeSupported {#mlresult-mlmediadrmiscryptoschemesupported}

```cpp
MLResult MLMediaDRMIsCryptoSchemeSupported(
    MLUUID uuid,
    const char * mime_type,
    bool * out_supported
)
```

Query if the given scheme identified by its UUID is supported on this device. And whether the drm plugin is able to handle the media container format. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLUUID](/api-ref/api/Modules/group___common/struct_m_l_u_u_i_d.md) |uuid|Identifies the universal unique ID of the crypto scheme. UUID must be 16 bytes. |
| const char * |mime_type|The MIME type of the media container, e.g. "video/mp4". If mime_type is not known or required, it can be provided as NULL. |
| bool * |out_supported|On successful return contains `true` or `false` based on whether the given crypto scheme is supported or not.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|The query has run successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMSetOnEventListenerEx {#mlresult-mlmediadrmsetoneventlistenerex}

```cpp
MLResult MLMediaDRMSetOnEventListenerEx(
    MLHandle media_drm,
    MLMediaDRMEventCallbacks * callbacks,
    void * data
)
```

Register a callback to be invoked when DRM events or updates or status change occurs. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMEventCallbacks](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_event_callbacks.md) * |callbacks|Set of event callbacks. Can be set to NULL to unset the callbacks altogether. |
| void * |data|Custom data to be returned when any callback is fired.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Event listener was set successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 





**API Level:**
  * 20




-----------

### MLMediaDRMOpenSession {#mlresult-mlmediadrmopensession}

```cpp
MLResult MLMediaDRMOpenSession(
    MLHandle media_drm,
    MLMediaDRMByteArray * out_session_id
)
```

Opens a new session. A session ID is returned. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_session_id|ID of the session created/opened. This byte array will be released when [MLMediaDRMCloseSession()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmclosesession) is called.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM session was opened successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMCloseSession {#mlresult-mlmediadrmclosesession}

```cpp
MLResult MLMediaDRMCloseSession(
    MLHandle media_drm,
    MLMediaDRMByteArray * session_id
)
```

Closes a session on the MLMediaDRM object that was previously opened with openSession(). 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session, which will be released on return.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM session was closed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMGetKeyRequest {#mlresult-mlmediadrmgetkeyrequest}

```cpp
MLResult MLMediaDRMGetKeyRequest(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMKeyRequestInputParam * key_request_param,
    MLMediaDRMRequestMessage * out_key_request
)
```

A key request/response exchange occurs between the app and a license server to obtain or release keys used to decrypt encrypted content. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMKeyRequestInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_request_input_param.md) * |key_request_param|Placeholder for needed arguments for generating a key request message. |
| [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * |out_key_request|Upon successful return, contains key request message. To free/release this, call [MLMediaDRMRequestMessageRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmrequestmessagerelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Key Request message is constructed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


[MLMediaDRMGetKeyRequest()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetkeyrequest) is used to obtain an opaque key request byte array that is delivered to the license server. The opaque key request byte array is returned in out_key_request.request The recommended URL to deliver the key request to is returned in out_key_request.default_URL.

After the app has received the key request response from the server, it should deliver to the response to the DRM engine plugin using the method [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).





-----------

### MLMediaDRMProvideKeyResponse {#mlresult-mlmediadrmprovidekeyresponse}

```cpp
MLResult MLMediaDRMProvideKeyResponse(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMByteArray * response,
    MLMediaDRMByteArray * out_key_set_id
)
```

A key response is received from the license server by the app, then it is provided to the DRM engine plugin using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse). 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |response|The opaque response from the server. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_key_set_id|Upon successful return, contains the key identifier. To free/release this buffer, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Key Response message was consumed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


When the response is for an offline key request, a key_set_id is returned that can be used to later restore the keys to a new session with restoreKeys(). When the response is for a streaming or release request, a null key_set_id is returned.





-----------

### MLMediaDRMRestoreKeys {#mlresult-mlmediadrmrestorekeys}

```cpp
MLResult MLMediaDRMRestoreKeys(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMByteArray * key_set_id
)
```

Restore persisted offline keys into a new session. key_set_id identifies the keys to load, obtained from a prior call to [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse). 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |key_set_id|The saved key set to restore.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Keys are restored successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMRemoveKeys {#mlresult-mlmediadrmremovekeys}

```cpp
MLResult MLMediaDRMRemoveKeys(
    MLHandle media_drm,
    MLMediaDRMByteArray * key_set_id
)
```

Remove the current keys from a session. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |key_set_id|The keys to remove, which will be released on success.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Keys are removed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMQueryKeyStatus {#mlresult-mlmediadrmquerykeystatus}

```cpp
MLResult MLMediaDRMQueryKeyStatus(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    MLMediaDRMKeyValueArray * out_info_map
)
```

Request an informative description of the key status for the session. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| [MLMediaDRMKeyValueArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_key_value_array.md) * |out_info_map|The Key-Value pair place-holder for the key status. To release/free this call [MLMediaDRMKeyValueArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmkeyvaluearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Query for MLMediaDRM Key status completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


The status is in the form of key/value pairs. Since DRM license policies vary by vendor, the specific status field names are determined by each DRM vendor. Refer to your DRM provider documentation for definitions of the field names for a particular DRM engine plugin.





-----------

### MLMediaDRMGetProvisionRequest {#mlresult-mlmediadrmgetprovisionrequest}

```cpp
MLResult MLMediaDRMGetProvisionRequest(
    MLHandle media_drm,
    const char * cert_type,
    MLMediaDRMRequestMessage * out_provision_request
)
```

A provision request/response exchange occurs between the app and a provisioning server to retrieve a device certificate. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const char * |cert_type|The device certificate type, which can be "none" or "X.509". |
| [MLMediaDRMRequestMessage](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_request_message.md) * |out_provision_request|Upon successful return, contains provision request message. To free/release this, call [MLMediaDRMRequestMessageRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmrequestmessagerelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Device Provision Request message is constructed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


If provisioning is required, the #EVENT_PROVISION_REQUIRED event will be sent to the event handler. [MLMediaDRMGetProvisionRequest()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetprovisionrequest) is used to obtain the opaque provision request byte array that should be delivered to the provisioning server.





-----------

### MLMediaDRMProvideProvisionResponse {#mlresult-mlmediadrmprovideprovisionresponse}

```cpp
MLResult MLMediaDRMProvideProvisionResponse(
    MLHandle media_drm,
    const MLMediaDRMByteArray * response,
    MLMediaDRMByteArray * out_certificate,
    MLMediaDRMByteArray * out_wrapped_key
)
```

After a provision response is received by the app, it is provided to the DRM engine plugin using this method. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |response|The opaque provisioning response byte array to provide to the DRM engine plugin. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_certificate|The device certificate upon sucessful return. To release/free this call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease). |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_wrapped_key|The wrapped device key upon sucessful return. To release/free this call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|Device Provision Response message is consumed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMGetSecureStops {#mlresult-mlmediadrmgetsecurestops}

```cpp
MLResult MLMediaDRMGetSecureStops(
    MLHandle media_drm,
    MLMediaDRMByteArrayList * out_secure_stops
)
```

Access all secure stops. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMByteArrayList](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array_list.md) * |out_secure_stops|List of all the secure stops upon successful return. To free/release call [MLMediaDRMByteArrayListRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearraylistrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Secure stops are retrieved successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


Secure Stop:

A means of enforcing limits on the number of concurrent streams per subscriber across devices is provided via #SecureStop. This is achieved by securely monitoring the lifetime of sessions.

Information from the server related to the current playback session is written to persistent storage on the device when each #MediaCrypto object is created.

In the normal case, playback will be completed, the session destroyed and the Secure Stops will be queried. The app queries secure stops and forwards the secure stop message to the server which verifies the signature and notifies the server side database that the session destruction has been confirmed.

The persisted record on the client is only removed after positive confirmation that the server received the message using releaseSecureStops().





-----------

### MLMediaDRMGetSecureStop {#mlresult-mlmediadrmgetsecurestop}

```cpp
MLResult MLMediaDRMGetSecureStop(
    MLHandle media_drm,
    const MLMediaDRMByteArray * ss_id,
    MLMediaDRMByteArray * out_secure_stop
)
```

Access secure stop by secure stop ID. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |ss_id|The ID for the DRM securestop session. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_secure_stop|The secure stop upon successful return. To free/release call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Secure stop is retrieved successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 




**See**: [MLMediaDRMGetSecureStops()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestops).



-----------

### MLMediaDRMReleaseSecureStops {#mlresult-mlmediadrmreleasesecurestops}

```cpp
MLResult MLMediaDRMReleaseSecureStops(
    MLHandle media_drm,
    const MLMediaDRMByteArray * secure_stop
)
```

Process the SecureStop server response message. After authenticating the message, remove the SecureStops identified in the response. See [MLMediaDRMGetSecureStops()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestops) for details. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |secure_stop|The server response indicating which secure stops to release.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM Secure stops are released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMReleaseAllSecureStops {#mlresult-mlmediadrmreleaseallsecurestops}

```cpp
MLResult MLMediaDRMReleaseAllSecureStops(
    MLHandle media_drm
)
```

Remove all the SecureStops. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|All secure stops for the MLMediaDRM are released successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 




**See**: [MLMediaDRMGetSecureStops()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmgetsecurestops).



-----------

### MLMediaDRMGetPropertyString {#mlresult-mlmediadrmgetpropertystring}

```cpp
MLResult MLMediaDRMGetPropertyString(
    MLHandle media_drm,
    MLMediaDRMProperty property_name,
    char ** out_property_value
)
```

Read a DRM engine plugin String property value, given the property name. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) |property_name|The property to query. Standard property names are:

* MLMediaDRMProperty_Vendor.
* MLMediaDRMProperty_Version.
* MLMediaDRMProperty_Description.
* MLMediaDRMProperty_Algorithms. |
| char ** |out_property_value|The property value upon successful return. Ownership is passed, call free(*out_property_value) to free it.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM property is retrieved successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMGetPropertyByteArray {#mlresult-mlmediadrmgetpropertybytearray}

```cpp
MLResult MLMediaDRMGetPropertyByteArray(
    MLHandle media_drm,
    MLMediaDRMProperty property_name,
    MLMediaDRMByteArray * out_property_value
)
```

Read a DRM engine plugin byte array property value, given the property name. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) |property_name|The property to query. Standard property names are:

* MLMediaDRMProperty_DeviceUniqueID. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_property_value|The property value upon successful return. To release/free call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM property is retrieved successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMSetPropertyString {#mlresult-mlmediadrmsetpropertystring}

```cpp
MLResult MLMediaDRMSetPropertyString(
    MLHandle media_drm,
    MLMediaDRMProperty property_name,
    const char * property_value
)
```

Set a DRM engine plugin String property value. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) |property_name|The property to query. Standard property names are:

* MLMediaDRMProperty_Vendor.
* MLMediaDRMProperty_Version.
* MLMediaDRMProperty_Description.
* MLMediaDRMProperty_Algorithms. |
| const char * |property_value|The value of the corresponding property.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM property is set successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMSetPropertyByteArray {#mlresult-mlmediadrmsetpropertybytearray}

```cpp
MLResult MLMediaDRMSetPropertyByteArray(
    MLHandle media_drm,
    MLMediaDRMProperty property_name,
    const MLMediaDRMByteArray * property_value
)
```

Set a DRM engine plugin byte array property value. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| [MLMediaDRMProperty](/api-ref/api/Modules/group___media_player/group___media_player.md#const-typedef-char-mlmediadrmproperty) |property_name|The property to query. Standard property names are:

* MLMediaDRMProperty_DeviceUniqueID. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |property_value|The value of the corresponding property.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM property is set successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------

### MLMediaDRMEncrypt {#mlresult-mlmediadrmencrypt}

```cpp
MLResult MLMediaDRMEncrypt(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMCryptoInputParam * crypto_key_param,
    const MLMediaDRMByteArray * input,
    MLMediaDRMByteArray * out_output
)
```

Encrypt the data referenced by input using algorithm if specified, and write the encrypted result into output. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md) * |crypto_key_param|Pointer to the structure that contains needed crypto arguments for encryption operation. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |input|The data that needs to be encrypted. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_output|The encrypted input upon successful return. To free/release this buffer, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM encryption operation has been completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


The key to use is identified by the 16 byte keyId. The key must have been loaded into the session using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).





-----------

### MLMediaDRMDecrypt {#mlresult-mlmediadrmdecrypt}

```cpp
MLResult MLMediaDRMDecrypt(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMCryptoInputParam * crypto_key_param,
    const MLMediaDRMByteArray * input,
    MLMediaDRMByteArray * out_output
)
```

Decrypt the data referenced by input using algorithm if specified, and write the encrypted result into output. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMCryptoInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_crypto_input_param.md) * |crypto_key_param|Pointer to the structure that contains needed crypto arguments for decryption operation. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |input|The data that needs to be decrypted. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_output|The decrypted input upon successful return. To free/release this buffer, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM decryption operation has been completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


The key to use is identified by the 16 byte keyId. The key must have been loaded into the session using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).





-----------

### MLMediaDRMSign {#mlresult-mlmediadrmsign}

```cpp
MLResult MLMediaDRMSign(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMHMACInputParam * hmac_key_param,
    const MLMediaDRMByteArray * message,
    MLMediaDRMByteArray * out_signature
)
```

Generate a signature using the specified algorithm (if provided) over the message data and store the signature. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md) * |hmac_key_param|Pointer to the structure that contains needed crypto arguments for HMAC operation. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |message|The data that needs to be signed. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_signature|The signature of the input message upon success. To free/release this buffer, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM HMAC Sign operation has been completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


The key to use is identified by the 16 byte keyId. The key must have been loaded into the session using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).





-----------

### MLMediaDRMVerify {#mlresult-mlmediadrmverify}

```cpp
MLResult MLMediaDRMVerify(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMHMACInputParam * hmac_key_param,
    const MLMediaDRMByteArray * message,
    const MLMediaDRMByteArray * signature,
    bool * out_match
)
```

Perform a signature verification using the specified algorithm (if specified) over the message data referenced by the message parameter. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMHMACInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_h_m_a_c_input_param.md) * |hmac_key_param|Pointer to the structure that contains needed crypto arguments for HMAC operation. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |message|The data for which signature needs to be verified. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |signature|The signature of the input message. |
| bool * |out_match|Pointer to bool, which would return "true" if the signature matches, "false" otherwise.|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM HMAC Verify operation has been completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 


The key must have been loaded into the session using [MLMediaDRMProvideKeyResponse()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmprovidekeyresponse).





-----------

### MLMediaDRMSignRSA {#mlresult-mlmediadrmsignrsa}

```cpp
MLResult MLMediaDRMSignRSA(
    MLHandle media_drm,
    const MLMediaDRMByteArray * session_id,
    const MLMediaDRMRSAInputParam * rsa_key_param,
    const MLMediaDRMByteArray * message,
    MLMediaDRMByteArray * out_signature
)
```

Generate a signature using the specified RSA Key and algorithm. 

**Parameters**

|  |   |   |
|--|--|--|
| [MLHandle](/api-ref/api/Modules/group___platform/group___platform.md#uint64-t-mlhandle) |media_drm|Handle to the MLMediaDRM. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |session_id|The session ID for the DRM session. |
| const [MLMediaDRMRSAInputParam](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_r_s_a_input_param.md) * |rsa_key_param|Pointer to the structure that contains needed key arguments for this RSA operation. |
| const [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |message|The data that needs to be signed. |
| [MLMediaDRMByteArray](/api-ref/api/Modules/group___media_player/struct_m_l_media_d_r_m_byte_array.md) * |out_signature|The signature of the input message upon success. To free/release this buffer, call [MLMediaDRMByteArrayRelease()](/api-ref/api/Modules/group___media_player/group___media_player.md#mlresult-mlmediadrmbytearrayrelease).|

**Returns**

|  |   |   |
|--|--|--|
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_InvalidParam|Parameter is invalid. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_Ok|MLMediaDRM RSA Sign operation has been completed successfully. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_PermissionDenied|Necessary permission is missing. |
| [MLResult](/api-ref/api/Modules/group___platform/group___platform.md#int32-t-mlresult) |MLResult_UnspecifiedFailure|The operation failed with an unspecified error.|
**Required Permissions**:

  * None 






-----------


## Attributes Documentation

### MLMediaDRMProperty {#const-typedef-char-mlmediadrmproperty}

```cpp
const typedef char * MLMediaDRMProperty;
```






-----------

### MLMediaDRMProperty_Vendor {#mlmediadrmproperty-mlmediadrmproperty-vendor}

```cpp
MLMediaDRMProperty MLMediaDRMProperty_Vendor;
```


String property name: identifies the maker of the DRM engine plugin. 





-----------

### MLMediaDRMProperty_Version {#mlmediadrmproperty-mlmediadrmproperty-version}

```cpp
MLMediaDRMProperty MLMediaDRMProperty_Version;
```


String property name: identifies the version of the DRM engine plugin. 





-----------

### MLMediaDRMProperty_Description {#mlmediadrmproperty-mlmediadrmproperty-description}

```cpp
MLMediaDRMProperty MLMediaDRMProperty_Description;
```


String property name: describes the DRM engine plugin. 





-----------

### MLMediaDRMProperty_Algorithms {#mlmediadrmproperty-mlmediadrmproperty-algorithms}

```cpp
MLMediaDRMProperty MLMediaDRMProperty_Algorithms;
```

String property name: a comma-separated list of cipher and mac algorithms supported by #CryptoSession. The list may be empty if the DRM engine plugin does not support #CryptoSession operations. 





-----------

### MLMediaDRMProperty_DeviceUniqueID {#mlmediadrmproperty-mlmediadrmproperty-deviceuniqueid}

```cpp
MLMediaDRMProperty MLMediaDRMProperty_DeviceUniqueID;
```

Byte array property name: the device unique identifier is established during device provisioning and provides a means of uniquely identifying each device. 





-----------


## Source code

```cpp
// %BANNER_BEGIN%
// ---------------------------------------------------------------------
// %COPYRIGHT_BEGIN%
// Copyright (c) 2017 Magic Leap, Inc. All Rights Reserved.
// Use of this file is governed by the Software License Agreement,
// located here: https://www.magicleap.com/software-license-agreement-ml2
// Terms and conditions applicable to third-party materials accompanying
// this distribution may also be found in the top-level NOTICE file
// appearing herein.
// %COPYRIGHT_END%
// ---------------------------------------------------------------------
// %BANNER_END%

#pragma once

#include "ml_api.h"
#include "ml_types.h"

ML_EXTERN_C_BEGIN

typedef const char *MLMediaDRMProperty;

ML_API extern MLMediaDRMProperty MLMediaDRMProperty_Vendor;

ML_API extern MLMediaDRMProperty MLMediaDRMProperty_Version;

ML_API extern MLMediaDRMProperty MLMediaDRMProperty_Description;

ML_API extern MLMediaDRMProperty MLMediaDRMProperty_Algorithms;

ML_API extern MLMediaDRMProperty MLMediaDRMProperty_DeviceUniqueID;

typedef struct MLMediaDRMByteArray {
  uint8_t *ptr;
  size_t length;
} MLMediaDRMByteArray;

typedef struct MLMediaDRMByteArrayList {
  MLMediaDRMByteArray *ptr;
  size_t length;
} MLMediaDRMByteArrayList;

typedef struct MLMediaDRMKeyValue {
  const char *key;
  const char *value;
} MLMediaDRMKeyValue;

typedef struct MLMediaDRMKeyValueArray {
  MLMediaDRMKeyValue *ptr;
  size_t length;
  size_t index;
} MLMediaDRMKeyValueArray;

typedef enum MLMediaDRMKeyType {
  MLMediaDRMKeyType_Streaming    = 1,
  MLMediaDRMKeyType_Offline      = 2,
  MLMediaDRMKeyType_Release      = 3,
  MLMediaDRMKeyType_Ensure32Bits = 0x7FFFFFFF
} MLMediaDRMKeyType;

typedef enum MLMediaDRMEventType {
  MLMediaDRMEventType_ProvisionRequired = 1,
  MLMediaDRMEventType_KeyRequired       = 2,
  MLMediaDRMEventType_KeyExpired        = 3,
  MLMediaDRMEventType_VendorDefined     = 4,
  MLMediaDRMEventType_SessionReclaimed = 5,
  MLMediaDRMEventType_ExpirationUpdate = 6,
  MLMediaDRMEventType_KeysChange = 7,
  MLMediaDRMEventType_Ensure32Bits      = 0x7FFFFFFF
} MLMediaDRMEventType;

typedef struct MLMediaDRMKeyRequestInputParam {
  MLMediaDRMByteArray *init_data;
  char *mime_type;
  MLMediaDRMKeyType key_type;
  MLMediaDRMKeyValueArray *optional_params;
} MLMediaDRMKeyRequestInputParam;

typedef struct MLMediaDRMRequestMessage {
  MLMediaDRMByteArray request;
  char *default_URL;
} MLMediaDRMRequestMessage;

typedef struct MLMediaDRMCryptoInputParam {
  char *algorithm;
  MLMediaDRMByteArray *key_set_id;
  MLMediaDRMByteArray *iv;
} MLMediaDRMCryptoInputParam;

typedef struct MLMediaDRMHMACInputParam {
  char *algorithm;
  MLMediaDRMByteArray *key_set_id;
} MLMediaDRMHMACInputParam;

typedef struct MLMediaDRMRSAInputParam {
  char *algorithm;
  MLMediaDRMByteArray *wrapped_rsa_key;
} MLMediaDRMRSAInputParam;

typedef struct MLMediaDRMEventInfo {
  MLMediaDRMByteArray *session_id;
  MLMediaDRMEventType event_type;
  int extra;
  MLMediaDRMByteArray *event_data;
  void *data;
} MLMediaDRMEventInfo;

typedef struct MLMediaDRMExpirationUpdateInfo {
  MLMediaDRMByteArray *session_id;
  uint64_t expiration_time_ms;
  void *data;
} MLMediaDRMExpirationUpdateInfo;

typedef enum MLMediaDRMKeyStatusCode {
  MLMediaDRMKeyStatusCode_KeyStatusUsable = 0,

  MLMediaDRMKeyStatusCode_KeyStatusExpired = 1,

  MLMediaDRMKeyStatusCode_KeyStatusOutputNotAllowed = 2,

  MLMediaDRMKeyStatusCode_KeyStatusPending = 3,

  MLMediaDRMKeyStatusCode_KeyStatusInternalError = 4,

  MLMediaDRMKeyStatusCode_Ensure32Bits = 0x7FFFFFFF
} MLMediaDRMKeyStatusCode;

typedef struct MLMediaDRMKeyStatus {
  MLMediaDRMByteArray key_id;
  MLMediaDRMKeyStatusCode status_code;
} MLMediaDRMKeyStatus;

typedef struct MLMediaDRMKeyStatusInfo {
  MLMediaDRMByteArray *session_id;
  size_t key_status_count;
  MLMediaDRMKeyStatus *key_status;
  bool has_new_usable_key;
  void *data;
} MLMediaDRMKeyStatusInfo;

typedef struct MLMediaDRMEventCallbacks {
  uint32_t version;

  void (*on_event)(MLHandle media_drm, const MLMediaDRMEventInfo *event_info);

  void (*on_expiration_update)(MLHandle media_drm, const MLMediaDRMExpirationUpdateInfo *update_info);

  void (*on_key_status_change)(MLHandle media_drm, const MLMediaDRMKeyStatusInfo *key_status_info);
} MLMediaDRMEventCallbacks;

ML_STATIC_INLINE void MLMediaDRMEventCallbacksInit(MLMediaDRMEventCallbacks *inout_callbacks) {
  if (inout_callbacks) {
    inout_callbacks->version = 1;
    inout_callbacks->on_event = NULL;
    inout_callbacks->on_expiration_update = NULL;
    inout_callbacks->on_key_status_change = NULL;
  }
}

ML_API MLResult ML_CALL MLMediaDRMByteArrayAllocate(size_t size, MLMediaDRMByteArray *out_array);

ML_API MLResult ML_CALL MLMediaDRMByteArrayAllocAndCopy(const uint8_t *copy_from, size_t size, MLMediaDRMByteArray *out_array);

ML_API MLResult ML_CALL MLMediaDRMKeyValueArrayAllocate(size_t size, MLMediaDRMKeyValueArray *out_array);

ML_API MLResult ML_CALL MLMediaDRMCreate(MLUUID uuid, MLHandle *out_handle);

ML_API MLResult ML_CALL MLMediaDRMRelease(MLHandle media_drm);

ML_API MLResult ML_CALL MLMediaDRMByteArrayRelease(MLMediaDRMByteArray *array);

ML_API MLResult ML_CALL MLMediaDRMByteArrayListRelease(MLMediaDRMByteArrayList *array);

ML_API MLResult ML_CALL MLMediaDRMKeyValueArrayRelease(MLMediaDRMKeyValueArray *array);

ML_API MLResult ML_CALL MLMediaDRMRequestMessageRelease(MLMediaDRMRequestMessage *request);

ML_API MLResult ML_CALL MLMediaDRMKeyValueArrayAdd(const MLMediaDRMKeyValue *pair, MLMediaDRMKeyValueArray *out_array);

ML_API MLResult ML_CALL MLMediaDRMIsCryptoSchemeSupported(MLUUID uuid, const char *mime_type, bool *out_supported);

ML_API MLResult ML_CALL MLMediaDRMSetOnEventListenerEx(MLHandle media_drm, MLMediaDRMEventCallbacks *callbacks, void *data);

ML_API MLResult ML_CALL MLMediaDRMOpenSession(MLHandle media_drm, MLMediaDRMByteArray *out_session_id);

ML_API MLResult ML_CALL MLMediaDRMCloseSession(MLHandle media_drm, MLMediaDRMByteArray *session_id);

ML_API MLResult ML_CALL MLMediaDRMGetKeyRequest(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMKeyRequestInputParam *key_request_param, MLMediaDRMRequestMessage *out_key_request);

ML_API MLResult ML_CALL MLMediaDRMProvideKeyResponse(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMByteArray *response, MLMediaDRMByteArray *out_key_set_id);

ML_API MLResult ML_CALL MLMediaDRMRestoreKeys(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMByteArray *key_set_id);

ML_API MLResult ML_CALL MLMediaDRMRemoveKeys(MLHandle media_drm, MLMediaDRMByteArray *key_set_id);

ML_API MLResult ML_CALL MLMediaDRMQueryKeyStatus(MLHandle media_drm, const MLMediaDRMByteArray *session_id, MLMediaDRMKeyValueArray *out_info_map);

ML_API MLResult ML_CALL MLMediaDRMGetProvisionRequest(MLHandle media_drm, const char *cert_type, MLMediaDRMRequestMessage *out_provision_request);

ML_API MLResult ML_CALL MLMediaDRMProvideProvisionResponse(MLHandle media_drm, const MLMediaDRMByteArray *response, MLMediaDRMByteArray *out_certificate, MLMediaDRMByteArray *out_wrapped_key);

ML_API MLResult ML_CALL MLMediaDRMGetSecureStops(MLHandle media_drm, MLMediaDRMByteArrayList *out_secure_stops);

ML_API MLResult ML_CALL MLMediaDRMGetSecureStop(MLHandle media_drm, const MLMediaDRMByteArray *ss_id, MLMediaDRMByteArray *out_secure_stop);

ML_API MLResult ML_CALL MLMediaDRMReleaseSecureStops(MLHandle media_drm, const MLMediaDRMByteArray *secure_stop);

ML_API MLResult ML_CALL MLMediaDRMReleaseAllSecureStops(MLHandle media_drm);

ML_API MLResult ML_CALL MLMediaDRMGetPropertyString(MLHandle media_drm, MLMediaDRMProperty property_name, char **out_property_value);

ML_API MLResult ML_CALL MLMediaDRMGetPropertyByteArray(MLHandle media_drm, MLMediaDRMProperty property_name, MLMediaDRMByteArray *out_property_value);

ML_API MLResult ML_CALL MLMediaDRMSetPropertyString(MLHandle media_drm, MLMediaDRMProperty property_name, const char *property_value);

ML_API MLResult ML_CALL MLMediaDRMSetPropertyByteArray(MLHandle media_drm, MLMediaDRMProperty property_name, const MLMediaDRMByteArray *property_value);

ML_API MLResult ML_CALL MLMediaDRMEncrypt(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMCryptoInputParam *crypto_key_param, const MLMediaDRMByteArray *input, MLMediaDRMByteArray *out_output);

ML_API MLResult ML_CALL MLMediaDRMDecrypt(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMCryptoInputParam *crypto_key_param, const MLMediaDRMByteArray *input, MLMediaDRMByteArray *out_output);

ML_API MLResult ML_CALL MLMediaDRMSign(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMHMACInputParam *hmac_key_param, const MLMediaDRMByteArray *message, MLMediaDRMByteArray *out_signature);

ML_API MLResult ML_CALL MLMediaDRMVerify(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMHMACInputParam *hmac_key_param, const MLMediaDRMByteArray *message, const MLMediaDRMByteArray *signature, bool *out_match);

ML_API MLResult ML_CALL MLMediaDRMSignRSA(MLHandle media_drm, const MLMediaDRMByteArray *session_id, const MLMediaDRMRSAInputParam *rsa_key_param, const MLMediaDRMByteArray *message, MLMediaDRMByteArray *out_signature);

ML_EXTERN_C_END
```



